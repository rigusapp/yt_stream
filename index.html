<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8"/>
<title>YT Stream Premium v15.1</title>
<style>
body{font-family:Arial;margin:0;background:#f6f6fb;display:flex;justify-content:center;padding:40px}
.container{background:white;padding:28px;border-radius:16px;width:100%;max-width:780px;box-shadow:0 8px 26px rgba(0,0,0,0.08)}
h1{margin:0;font-size:24px;font-weight:700}
label{margin-top:14px;display:block;font-weight:600}
input,select,textarea{width:100%;padding:12px;margin-top:6px;border:1px solid #ddd;border-radius:8px;background:#fafafa}
textarea{min-height:100px}
button{margin-top:20px;padding:14px;width:100%;background:#e53935;border:none;border-radius:10px;color:white;font-size:17px;font-weight:700;cursor:pointer}
pre{background:#111;color:#0f0;margin-top:14px;padding:14px;border-radius:8px;display:none;white-space:pre-wrap}
</style>
</head>
<body>

<div class="container">
<h1>YT Stream Premium v15.1</h1>

<label>Judul Video</label>
<input id="title">

<label>Visibilitas</label>
<select id="visibility">
<option value="public">Public</option>
<option value="unlisted">Unlisted</option>
<option value="private">Private</option>
</select>

<label>Deskripsi</label>
<textarea id="description"></textarea>

<label>Stream Key (YouTube)</label>
<input id="streamKey" placeholder="xxxx-xxxx-xxxx-xxxx">

<label>Video URL</label>
<input id="video">

<label>Tanggal & Jam Live (WIB)</label>
<input id="datetime" type="datetime-local">

<label>Durasi</label>
<select id="duration">
<option value="3600">1 Jam</option>
<option value="7200">2 Jam</option>
<option value="10800">3 Jam</option>
<option value="14400">4 Jam</option>
</select>

<label>Seamless Loop</label>
<select id="seamless">
<option value="false">Tidak</option>
<option value="true">Ya</option>
</select>

<button id="startBtn">Mulai Streaming</button>
<div id="log"></div>
<pre id="resp"></pre>
</div>

<script>
const WORKER_URL = "https://ytstream-proxy.rigus-apps.workers.dev/";
function convert(datetime){
  const d=new Date(datetime);
  const u=new Date(d.getTime()-7*3600*1000);
  return u.toISOString().split('.')[0]+"Z";
}
async function post(url,data){
  const r=await fetch(url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)});
  return {ok:r.ok,status:r.status,text:await r.text()};
}
document.getElementById("startBtn").onclick=async()=>{
  const streamKey=document.getElementById("streamKey").value.trim();
  if(!streamKey){alert("Stream Key wajib diisi!");return;}
  const payload={
    repo:"rigusapp/yt_stream",
    title:document.getElementById("title").value.trim(),
    visibility:document.getElementById("visibility").value,
    description:document.getElementById("description").value.trim(),
    stream_key:streamKey,
    video_url:document.getElementById("video").value.trim(),
    start_time:convert(document.getElementById("datetime").value.trim()),
    duration_seconds:document.getElementById("duration").value,
    seamless:document.getElementById("seamless").value
  };
  const log=document.getElementById("log");
  const resp=document.getElementById("resp");
  log.innerHTML="Mengirim...";
  const r=await post(WORKER_URL,payload);
  log.innerHTML=r.ok?"Terkirim ✓":"Gagal ✗";
  resp.style.display="block";
  resp.textContent=r.text.replace(streamKey,"***** MASKED *****");
}
</script>
</body>
</html>
