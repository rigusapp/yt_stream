name: Proxy Listener (repository_dispatch)

on:
  repository_dispatch:
    types: [stream_trigger]

jobs:
  proxy:
    runs-on: ubuntu-latest
    steps:
      - name: Show payload
        run: echo "Payload: ${{ toJson(github.event.client_payload) }}"

      - name: Trigger stream using composite action
        uses: ./.github/actions/trigger
        with:
          video_url: ${{ github.event.client_payload.video_url }}
          start_time: ${{ github.event.client_payload.start_time }}
          duration_seconds: ${{ github.event.client_payload.duration_seconds }}
          seamless: ${{ github.event.client_payload.seamless }}
        env:
          GH_PAT: ${{ secrets.GH_PAT }}
